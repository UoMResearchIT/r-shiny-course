<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="description" content="An introduction to Shiny">
<meta name="author" content="David Mawdsley">

    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>Reactive data :: Introduction to Shiny</title>

    
    <link href="../../css/nucleus.css?1634553224" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1634553224" rel="stylesheet">
    <link href="../../css/hybrid.css?1634553224" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1634553224" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1634553224" rel="stylesheet">
    <link href="../../css/auto-complete.css?1634553224" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1634553224" rel="stylesheet">
    <link href="../../css/theme.css?1634553224" rel="stylesheet">
    <link href="../../css/tabs.css?1634553224" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1634553224" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1634553224"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="../../goingfurther/reactive/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img src='https://assets.manchester.ac.uk/logos/hi-res/TAB_UNI_MAIN_logo/Coloured_backgrounds/TAB_col_background.png'>

    </div>
    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='../../'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/basics/" title="Getting started" class="dd-item
        
        
        
        ">
      <a href="../../basics/">
          <b>1. </b>Getting started
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ui/" title="User Interface design" class="dd-item
        
        
        
        ">
      <a href="../../ui/">
          <b>2. </b>User Interface design
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/plotting/" title="Producing plots" class="dd-item
        
        
        
        ">
      <a href="../../plotting/">
          <b>3. </b>Producing plots
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/together/" title="Putting it all together" class="dd-item
        
        
        
        ">
      <a href="../../together/">
          <b>4. </b>Putting it all together
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/deploy/" title="Deploying Shiny apps" class="dd-item
        
        
        
        ">
      <a href="../../deploy/">
          <b>5. </b>Deploying Shiny apps
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/goingfurther/" title="Going further" class="dd-item
        parent
        
        
        ">
      <a href="../../goingfurther/">
          <b>6. </b>Going further
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/goingfurther/reactive/" title="Reactive data" class="dd-item active">
        <a href="../../goingfurther/reactive/">
        Reactive data
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/goingfurther/graphs/" title="Interacting with graphs" class="dd-item
        
        
        
        ">
      <a href="../../goingfurther/graphs/">
          Interacting with graphs
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/goingfurther/layout/" title="App layout" class="dd-item
        
        
        
        ">
      <a href="../../goingfurther/layout/">
          App layout
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="../../about/">About</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/UoMResearchIT/r-shiny-course/raw/master/runningExample.zip">Download materials</a>
              </li>
          
              <li>
                  <a class="padding" href="http://bit.ly/2xP95Ef">Feedback</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/uomresearchit/r-shiny-course-materials/">GitHub materials</a>
              </li>
          
              <li>
                  <a class="padding" href="../../">Home</a>
              </li>
          
              <li>
                  <a class="padding" href="../../slides/">Slides</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Introduction to Shiny</a> > <a href='../../goingfurther/'>Going further</a> > Reactive data
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#exercise">Exercise</a></li>
        <li><a href="#solution">Solution</a></li>
        <li><a href="#solution-1">Solution</a></li>
      </ul>
    </li>
    <li><a href="#debugging-with-reactive-objects">Debugging with reactive objects</a>
      <ul>
        <li><a href="#other-approaches-to-debugging">Other approaches to debugging</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Reactive data
            </h1>
          

        


<p>In this example we only use the filtered gapminder data in a single place - to plot the graph.   For this reason we did the filtering within the <code>renderPlot()</code> function.</p>
<p>Let&rsquo;s add another output to the app; we&rsquo;ll show which country is the richest displayed on the graph, and what its GDP per capita is. This means that we&rsquo;ll be using the gapminder data filtered by year and country in two places; on the graph itself and in the logic where we work out what the richest country is.</p>
<p>To do this, we&rsquo;ll make the a reactive expression, which contains the data we want to plot.  A reactive expression is an expression whose value can change during the running of the app.   As mentioned previously, the reactive programming approach means that Shiny will keep track of when reactive expressions have become invalid (for example, if their inputs have changed - in this example if <code>year</code> or <code>continent</code> change), and will then recalculate them automatically.</p>
<p>Schematically, we have:</p>

<div class="mermaid" align="left">
graph LR;
   A[input$year] --> B[plotData]
   B --> C[output$gapminderPlot]
   D[input$continent] --> B
</div>

<p>Let&rsquo;s make the plotted data a reactive expression. We add the following code to the <code>server()</code> function:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">   <span style="color:#999;font-style:italic"># The data we wish to plot</span>
   plotData &lt;- <span style="color:#447fcf">reactive</span>({
     gapminder %&gt;% 
       <span style="color:#447fcf">filter</span>(year == input$year) %&gt;% 
       <span style="color:#447fcf">filter</span>(continent %in% input$continent)
   })
</code></pre></div><p>Reactive expressions return a function, so we refer to the data we&rsquo;re plotting as <code>plotData()</code>.  We can use this in our <code>renderPlot()</code> function:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">   output$gapminderPlot &lt;- <span style="color:#447fcf">renderPlot</span>({
      <span style="color:#447fcf">plotData</span>() %&gt;% 
         <span style="color:#447fcf">produceGapminderPlot</span>() })
</code></pre></div><p>The app will behave in the same way as before, but by defining the reactive expression <code>plotData()</code> we can use the data that we&rsquo;re plotting on the graph elsewhere in the app. <a href="https://github.com/UoMResearchIT/r-shiny-course-materials/commit/4ee4c74ebc63242c13fa772992a0de067f1a1622">07_reactivedata</a></p>
<h3 id="exercise">Exercise</h3>
<ul>
<li>The <code>renderTable()</code> function will render a tibble, and <code>tableOutput()</code> will display it.   Use these functions, with the reactive data to display a (long) table containing the data displayed on the graph.</li>
</ul>
<h3 id="solution">Solution</h3>
<p><a href="https://github.com/UoMResearchIT/r-shiny-course-materials/commit/b373f1f596296184f7bc2f98b28bf87e3de52522">08_showplotdata</a></p>

<div class="notices tip" ><p>There are two ways of displaying tabular data in Shiny.  <code>renderTable()</code> and <code>tableOutput()</code> will show a non-interactive tibble.  You can also use <code>renderDataTable()</code> and <code>dataTableOutput()</code> to give an interactive table that can be sorted, filtered etc.</p>
</div>

<ul>
<li>The <code>getRichestCountry()</code> function in <code>plottingFunctions.R</code> will return a tibble containing the name of the richest country in a tibble, and the country&rsquo;s GDP per capita. Modify your <code>renderTable()</code> function to only display this information for the displayed graph.</li>
</ul>
<h3 id="solution-1">Solution</h3>
<p><a href="https://github.com/UoMResearchIT/r-shiny-course-materials/commit/c48240c18327612d9228e7f8255f53cb131b6d1a">09_richcountry</a></p>
<h2 id="debugging-with-reactive-objects">Debugging with reactive objects</h2>
<p>If something goes wrong, Shiny apps can be more complicated to debug than regular R code.  Because code runs in response to events, rather than our script running linearly, it can be complicated to work out the state of your code at a given moment. Printing the values of variables, using, e.g. <code>print(myvar)</code>,  is one of the most straightforward ways of trying to work out what&rsquo;s going on, but this is a bit more complex when we&rsquo;re working with reactive objects and data.</p>
<p>You can only &ldquo;see&rdquo; reactive objects, such as <code>input$year</code> or <code>plotData()</code> from within a reactive context.  This means that we have to access reactive object within a reactive expression, such as <code>renderPlot()</code>, or using an observer (which we&rsquo;ll cover in a moment).  This means that we can&rsquo;t inspect the value of, e.g. <code>input$year</code> by putting a <code>print(input$year)</code> as free code within our server function.</p>
<p>There are two ways around this:</p>
<ul>
<li>Put your debug <code>print()</code> statement within a reactive expression.  For example, we could print the value of <code>input$year</code> whenever the graph is updated using:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">output$gapminderPlot &lt;- <span style="color:#447fcf">renderPlot</span>({
   <span style="color:#447fcf">print</span>(input$year)
   
   <span style="color:#447fcf">plotData</span>() %&gt;% 
      <span style="color:#447fcf">produceGapminderPlot</span>()
})
</code></pre></div><ul>
<li>Use the <code>observe()</code> function to observe the value of a reactive expression.  The expression in the observe function will be updated whenever its dependencies change.  If we add the expression:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#447fcf">observe</span>(<span style="color:#447fcf">print</span>(input$year))
</code></pre></div><p>to our server function, the <code>print()</code> function will be executed whenever the value of <code>input$year</code> changes.</p>
<p>There is a subtle difference between these two approaches.  The <code>observe()</code> function will run whenever its value changes.  The code in the <code>renderPlot()</code> function is only executed when the plot is updated.</p>
<h3 id="other-approaches-to-debugging">Other approaches to debugging</h3>
<p><a href="https://shiny.rstudio.com/articles/debugging.html">Rstudio provide a helpful guide to other approaches to debugging Shiny apps</a>.  If parts of your app aren&rsquo;t updating when you think they should be (or are updating when you don&rsquo;t think they should be), I&rsquo;ve found the reactive log approach they describe very helpful.  This shows you a graph illustrating the relationship between the various events occurring in the app.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../goingfurther/" title="Going further"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../goingfurther/graphs/" title="Interacting with graphs" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1634553224"></script>
    <script src="../../js/perfect-scrollbar.min.js?1634553224"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1634553224"></script>
    <script src="../../js/jquery.sticky.js?1634553224"></script>
    <script src="../../js/featherlight.min.js?1634553224"></script>
    <script src="../../js/highlight.pack.js?1634553224"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1634553224"></script>
    <script src="../../js/learn.js?1634553224"></script>
    <script src="../../js/hugo-learn.js?1634553224"></script>
    
        
            <script src="../../mermaid/mermaid.js?1634553224"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

